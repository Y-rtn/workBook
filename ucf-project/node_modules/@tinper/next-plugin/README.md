## TinperNextServer插件
TNS插件用于统一前端三方包及微前端应用组件或页面组件以服务方式共享外部使用的公共技术解决方案

## 1.插件安装
```
npm i ynpm-tool -g

ynpm i @tinper/next-plugin
```

## 2.插件使用
```
import {TNSClientPlugin} from '@tinper/next-plugin';

// webpack5.0以上版本配置如下：
{
    // ...
    plugins:[
        new TNSClientPlugin()
    ]
    // ...
}

```
## 插件配置
### 常规配置说明
| 参数 | 说明 | 类型 | 默认值 | 版本 |
| --- | --- | --- | --- | --- |
|providerName|提供方名字：需要共享输出给外部使用的服务名|
|providerEntry|提供方条目：需要共享输出给外部使用的组件或页面入口|object{string:string}|
|consumer|消费方：需要使用的外部服务名及资源地址，格式规范为：{'服务别名':'服务名@//localhost.com/服务名.js'}|object|
|excludeModules|需要排除的包名集合，即不使用TNS服务所提供的包名在此维护|Array[string]|-|
|protocol|协议类型"http"、"https"|string|默认为空值，即为相对协议|

### 调试配置说明
| 参数 | 说明 | 类型 | 默认值 | 版本 |
| --- | --- | --- | --- | --- |
|libraryEnv|三方包资源的来源环境标识或自定义url地址|string(local、test、daily、pre、online、auto、自定义url地址)|auto|
|libraryDebug|是否使用对应环境的调试库(即非压缩版脚本)，此参数值应该依据环境动态配置，本地开发态启用，线上生产态禁用|-|
|remotePluginEnv|远程插件的来源环境标识或自定义url地址|string(local、test、daily、pre、online、自定义url地址)|online|
|logFileName|日志文件的生成路径位置，默认生成到同级目录tns.log，设置为false则关闭日志文件|string|-|
|externalType|扩展引入方式"script"或"var"|string|-|

### 沙箱配置说明
| 参数 | 说明 | 类型 | 默认值 | 版本 |
| --- | --- | --- | --- | --- |
|cssSandbox|是否需要进行CSS样式隔离，设置true后自动增加隔离样式名，例如：".classA" 转换为 ".{providerName} .classA" ，仅当providerName存在时生效|正则表达式|false

## 高阶用法
### 微服务共享组件(示例一)
```text
  名词说明：
  服务消费方：在本应用(项目)中的使用其它应用(项目)中的组件，称为服务消费方（即：甲方）。
  服务提供方：将本应用(项目)中的组件共享给其它应用(项目)使用的，称为服务提供方（即：乙方）。
```
    
##### 服务提供方(app01)配置：
```js
new TNSClientPlugin({
    // 对外提供为"app01"的服务名
    providerName:'app01',
    // 对外提供以下组件(页面)
    providerEntry:{
        './AcButton':'./src/components/AcButton.js',
        './AcDialog':'./src/components/AcDialog.js',
        './AcPage':'./src/pages/AcPage.js'
    }
});
```

##### 服务消费方(app02)配置：
```js
// webpack的插件配置：
new TNSClientPlugin({
    // 使用"app01"提供的服务
    consumer:{
        'app01':'app01@//xxx.yyuap.com:8080/app01.js'
    }
});

// 项目代码中引用app01提供的组件(页面)：
import AcButton from 'app01/AcButton';
import AcDailog from 'app01/AcDailog';
import AcPage from 'app01/AcPage';

```

### 消费方自定义服务名别名(示例二)
##### 服务消费方(app02)配置：
```js
// webpack的插件配置：
new TNSClientPlugin({
    // 使用"app01"提供的服务,自定义为"aliasApp"别名。
    consumer:{
        'aliasApp':'app01@//xxx.yyuap.com:8080/app01.js'
    }
});

// 项目代码中通过别名引用app01提供的组件或页面：
import AcButton from 'aliasApp/AcButton';
import AcDailog from 'aliasApp/AcDailog';
import AcPage from 'aliasApp/AcPage';

```

### 插件开发者调试方法
```js
const {TNSClientPlugin} = require('@tinper/next-plugin');
const TNSRemotePlugin = require('../../tns-plugin/dist/server/TNSRemotePlugin');

// webpack配置
new TNSClientPlugin({
  remotePluginEnv:TNSRemotePlugin //使用本地插件实例
})
```
